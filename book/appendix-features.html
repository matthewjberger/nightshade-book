<!DOCTYPE HTML>
<html lang="en" class="dark sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Feature Flags - Nightshade Game Engine</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "dark";
            const default_dark_theme = "ayu";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Nightshade Game Engine</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="feature-flags"><a class="header" href="#feature-flags">Feature Flags</a></h1>
<p>Nightshade uses Cargo feature flags to enable optional functionality. This allows you to include only the features you need, reducing compile times and binary size.</p>
<h2 id="default-features"><a class="header" href="#default-features">Default Features</a></h2>
<p>Nightshade defaults to <code>["engine", "wgpu"]</code>:</p>
<pre><code class="language-toml">[dependencies]
nightshade = { git = "https://github.com/matthewjberger/nightshade.git" }
</code></pre>
<p>This gives you the full engine with the wgpu rendering backend. You only need to specify features explicitly if you want additional optional features or a minimal configuration.</p>
<h2 id="aggregate-features"><a class="header" href="#aggregate-features">Aggregate Features</a></h2>
<h3 id="engine-default"><a class="header" href="#engine-default"><code>engine</code> (default)</a></h3>
<p>The main engine feature. Includes everything needed for building games.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["engine"] }
</code></pre>
<p><strong>Includes:</strong> <code>runtime</code>, <code>assets</code>, <code>scene_graph</code>, <code>picking</code>, <code>file_dialog</code>, <code>async_runtime</code>, <code>terrain</code>, <code>screenshot</code>, plus rand, rayon, ehttp, futures, and WASM support libraries (js-sys, wasm-bindgen, wasm-bindgen-futures, web-sys).</p>
<p><strong>Provides:</strong></p>
<ul>
<li>Window creation and event loop</li>
<li>wgpu rendering backend</li>
<li>ECS (freecs)</li>
<li>Transform hierarchy</li>
<li>Camera systems</li>
<li>Mesh rendering and GPU instancing</li>
<li>PBR material system</li>
<li>Lighting (directional, point, spot) with shadows</li>
<li>Post-processing (bloom, SSAO, depth of field, tonemapping)</li>
<li>Procedural atmospheres (sky, clouds, space, nebula)</li>
<li>glTF/GLB model loading</li>
<li>Scene save/load</li>
<li>Input handling (keyboard, mouse, touch)</li>
<li>Procedural terrain</li>
<li>Picking (bounding box ray casting)</li>
<li>File dialogs</li>
<li>Screenshot capture</li>
</ul>
<h3 id="runtime"><a class="header" href="#runtime"><code>runtime</code></a></h3>
<p>Minimal rendering without asset loading. Use for lightweight apps that don't need glTF/image loading.</p>
<pre><code class="language-toml">nightshade = { default-features = false, features = ["runtime", "wgpu", "egui"] }
</code></pre>
<p><strong>Includes:</strong> <code>core</code>, <code>text</code>, <code>behaviors</code>.</p>
<h3 id="full"><a class="header" href="#full"><code>full</code></a></h3>
<p>Everything in <code>engine</code> plus all major optional features.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["full"] }
</code></pre>
<p><strong>Includes:</strong> <code>engine</code>, <code>wgpu</code>, <code>egui</code>, <code>shell</code>, <code>audio</code>, <code>physics</code>, <code>gamepad</code>, <code>navmesh</code>, <code>scripting</code>, <code>fbx</code>, <code>lattice</code>, <code>sdf_sculpt</code>, <code>mosaic</code>, <code>editor</code>, <code>plugins</code>.</p>
<h2 id="granular-features"><a class="header" href="#granular-features">Granular Features</a></h2>
<p>These provide fine-grained control over dependencies:</p>
<h3 id="core"><a class="header" href="#core"><code>core</code></a></h3>
<p>Foundation: ECS (freecs), math (nalgebra, nalgebra-glm), windowing (winit), time (web-time), graph (petgraph), tracing, UUIDs, JSON serialization.</p>
<h3 id="text"><a class="header" href="#text"><code>text</code></a></h3>
<p>3D text rendering using fontdue. Requires <code>core</code>.</p>
<h3 id="assets"><a class="header" href="#assets"><code>assets</code></a></h3>
<p>Asset loading: gltf, image, half, bincode, serde_json, lz4 compression. Requires <code>core</code>.</p>
<h3 id="scene_graph"><a class="header" href="#scene_graph"><code>scene_graph</code></a></h3>
<p>Scene hierarchy system with save/load. Requires <code>assets</code>.</p>
<h3 id="terrain"><a class="header" href="#terrain"><code>terrain</code></a></h3>
<p>Procedural terrain generation using noise and rand. Requires <code>core</code>.</p>
<h3 id="file_dialog"><a class="header" href="#file_dialog"><code>file_dialog</code></a></h3>
<p>Native file dialogs using rfd and dirs. Enables the native-only functions in <code>nightshade::filesystem</code> (<code>pick_file</code>, <code>pick_folder</code>, <code>save_file_dialog</code>, <code>read_file</code>, <code>write_file</code>). The cross-platform functions (<code>save_file</code>, <code>request_file_load</code>) are always available on WASM and require this feature on native. See the <a href="filesystem.html">File System</a> chapter. Requires <code>core</code>.</p>
<h3 id="async_runtime"><a class="header" href="#async_runtime"><code>async_runtime</code></a></h3>
<p>Tokio async runtime for non-blocking operations. Requires <code>core</code>.</p>
<h3 id="screenshot"><a class="header" href="#screenshot"><code>screenshot</code></a></h3>
<p>PNG screenshot saving using image.</p>
<h3 id="picking"><a class="header" href="#picking"><code>picking</code></a></h3>
<p>Ray-based entity picking with bounding box intersection. Trimesh picking requires <code>physics</code>.</p>
<h3 id="behaviors"><a class="header" href="#behaviors"><code>behaviors</code></a></h3>
<p>Built-in behavior components and systems.</p>
<h2 id="rendering"><a class="header" href="#rendering">Rendering</a></h2>
<h3 id="wgpu-default"><a class="header" href="#wgpu-default"><code>wgpu</code> (default)</a></h3>
<p>WebGPU-based rendering backend supporting DirectX 12, Metal, Vulkan, and WebGPU.</p>
<h2 id="optional-features"><a class="header" href="#optional-features">Optional Features</a></h2>
<h3 id="egui"><a class="header" href="#egui"><code>egui</code></a></h3>
<p>Immediate mode GUI framework. Enables <code>fn ui()</code> on the State trait.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["egui"] }
</code></pre>
<p><strong>Additional Dependencies:</strong> egui, egui_extras, egui-winit, egui-wgpu, egui_tiles</p>
<h3 id="shell"><a class="header" href="#shell"><code>shell</code></a></h3>
<p>Developer console with command registration. Press backtick to open. Requires <code>egui</code>.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["shell"] }
</code></pre>
<h3 id="audio"><a class="header" href="#audio"><code>audio</code></a></h3>
<p>Audio playback using Kira.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["audio"] }
</code></pre>
<p><strong>Provides:</strong></p>
<ul>
<li>Sound loading (WAV, OGG, MP3, FLAC)</li>
<li>Sound playback with volume, pitch, panning</li>
<li>Spatial/3D audio with distance attenuation</li>
<li>Audio listener and source components</li>
<li>Looping and one-shot sounds</li>
</ul>
<h3 id="fft"><a class="header" href="#fft"><code>fft</code></a></h3>
<p>FFT-based audio analysis for music-reactive applications.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["fft"] }
</code></pre>
<p><strong>Provides:</strong></p>
<ul>
<li>Real-time FFT spectral analysis</li>
<li>Six-band frequency decomposition (sub-bass to highs)</li>
<li>Beat detection (kick, snare, hi-hat)</li>
<li>BPM estimation and beat phase tracking</li>
<li>Spectral features (centroid, flatness, rolloff, flux)</li>
<li>Onset detection with adaptive thresholding</li>
</ul>
<p><strong>Additional Dependencies:</strong> rustfft</p>
<h3 id="physics"><a class="header" href="#physics"><code>physics</code></a></h3>
<p>Rapier3D physics integration.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["physics"] }
</code></pre>
<p><strong>Provides:</strong></p>
<ul>
<li>Rigid body simulation (dynamic, kinematic, static)</li>
<li>Collider shapes (box, sphere, capsule, cylinder, cone, convex hull, trimesh, heightfield)</li>
<li>Collision detection</li>
<li>Character controllers</li>
<li>Physics interpolation for smooth rendering</li>
<li>Trimesh picking (when combined with <code>picking</code>)</li>
</ul>
<p><strong>Additional Dependencies:</strong> rapier3d</p>
<h3 id="gamepad"><a class="header" href="#gamepad"><code>gamepad</code></a></h3>
<p>Gamepad/controller support via gilrs.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["gamepad"] }
</code></pre>
<p><strong>Provides:</strong></p>
<ul>
<li>Gamepad detection and hot-plugging</li>
<li>Button input (face buttons, triggers, bumpers, D-pad)</li>
<li>Analog stick input with deadzone handling</li>
<li>Trigger pressure (0.0 - 1.0)</li>
<li>Rumble/vibration</li>
<li>Multiple gamepad support</li>
</ul>
<h3 id="navmesh"><a class="header" href="#navmesh"><code>navmesh</code></a></h3>
<p>AI navigation mesh generation via Recast.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["navmesh"] }
</code></pre>
<p><strong>Provides:</strong></p>
<ul>
<li>Navigation mesh generation from world geometry</li>
<li>A* and Dijkstra pathfinding</li>
<li>NavMesh agent component with autonomous movement</li>
<li>Height sampling on navigation mesh</li>
<li>Debug visualization</li>
</ul>
<p><strong>Additional Dependencies:</strong> rerecast, glam</p>
<h3 id="scripting"><a class="header" href="#scripting"><code>scripting</code></a></h3>
<p>Rhai scripting runtime for dynamic behavior.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["scripting"] }
</code></pre>
<h3 id="fbx"><a class="header" href="#fbx"><code>fbx</code></a></h3>
<p>FBX model loading using ufbx. Requires <code>assets</code>.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["fbx"] }
</code></pre>
<h3 id="lattice"><a class="header" href="#lattice"><code>lattice</code></a></h3>
<p>Lattice deformation system for free-form mesh deformation.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["lattice"] }
</code></pre>
<h3 id="sdf_sculpt"><a class="header" href="#sdf_sculpt"><code>sdf_sculpt</code></a></h3>
<p>Signed Distance Field sculpting system.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["sdf_sculpt"] }
</code></pre>
<h2 id="platform-features"><a class="header" href="#platform-features">Platform Features</a></h2>
<h3 id="openxr"><a class="header" href="#openxr"><code>openxr</code></a></h3>
<p>OpenXR VR support. Uses Vulkan backend. Provides <code>launch_xr()</code> entry point, VR input (head/hand tracking, controllers), and locomotion.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["openxr"] }
</code></pre>
<p><strong>Additional Dependencies:</strong> openxr, ash, wgpu-hal, gpu-allocator</p>
<h3 id="steam"><a class="header" href="#steam"><code>steam</code></a></h3>
<p>Steamworks integration for achievements, stats, multiplayer, and friends.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["steam"] }
</code></pre>
<p><strong>Additional Dependencies:</strong> steamworks, steamworks-sys</p>
<h3 id="webview"><a class="header" href="#webview"><code>webview</code></a></h3>
<p>Bidirectional IPC for hosting web frontends (Leptos, Yew, etc.) inside a nightshade window.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["webview"] }
</code></pre>
<p><strong>Additional Dependencies:</strong> wry, tiny_http, include_dir, wasm-bindgen, js-sys, web-sys</p>
<h3 id="mosaic"><a class="header" href="#mosaic"><code>mosaic</code></a></h3>
<p>Multi-pane desktop application framework built on <code>egui_tiles</code>. Provides dockable tile-based layouts, a <code>Widget</code> trait for serializable panes, theming with 11 presets, modal dialogs, toast notifications, command palettes, keyboard shortcuts, file dialogs, project save/load, status bars, FPS counters, undo/redo history, clipboard helpers, drag-and-drop support, and a built-in <code>ViewportWidget</code> for rendering camera outputs.</p>
<p>Requires <code>egui</code>.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["mosaic"] }
</code></pre>
<p><strong>Key types:</strong> <code>Mosaic</code>, <code>Widget</code>, <code>Pane</code>, <code>WidgetContext</code>, <code>ViewportWidget</code>, <code>ThemeState</code>, <code>Modals</code>, <code>Toasts</code>, <code>StatusBar</code>, <code>CommandPalette</code>, <code>ShortcutManager</code>, <code>Settings</code>, <code>EventLog</code>, <code>FpsCounter</code>, <code>MosaicConfig</code>, <code>ProjectSaveFile</code>, <code>LayoutEvent</code></p>
<h3 id="editor"><a class="header" href="#editor"><code>editor</code></a></h3>
<p>Scene editor infrastructure for building custom editors. Provides gizmo manipulation, undo/redo, component inspectors, entity picking, selection management, clipboard operations, keyboard shortcuts, scene tree UI, context menus, camera controls, and asset loading utilities.</p>
<p>Requires <code>mosaic</code> and <code>picking</code>.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["editor"] }
</code></pre>
<p><strong>Provides:</strong></p>
<ul>
<li>Transform gizmos (translate, rotate, scale) with local/global coordinate spaces</li>
<li>Modal transform operations (Blender-style G/R/S keys with axis constraints)</li>
<li>Undo/redo history with entity snapshots</li>
<li>Component inspector UI for all built-in components</li>
<li>GPU-based entity picking and marquee selection</li>
<li>Entity selection with multi-select, copy/paste, duplicate</li>
<li>Scene tree with drag-and-drop reparenting</li>
<li>Context menus and add-node modal</li>
<li>Camera view presets and ortho toggle</li>
<li>Keyboard shortcut handler (Blender-style)</li>
<li>Code editor with syntax highlighting (syntect, native only)</li>
<li>Clipboard integration (arboard, native only)</li>
</ul>
<p><strong>Additional Dependencies:</strong> syntect (native only), arboard (native only)</p>
<p><strong>Key types:</strong> <code>EditorContext</code>, <code>UndoHistory</code>, <code>ComponentInspectorUi</code>, <code>InspectorContext</code>, <code>WorldTreeUi</code>, <code>EntitySelection</code>, <code>TreeCache</code>, <code>GizmoInteraction</code>, <code>InputSignal</code></p>
<h3 id="windows-app-icon"><a class="header" href="#windows-app-icon"><code>windows-app-icon</code></a></h3>
<p>Embed a custom icon into Windows executables at build time.</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["windows-app-icon"] }
</code></pre>
<p><strong>Additional Dependencies:</strong> winresource, ico, image</p>
<h2 id="profiling-features"><a class="header" href="#profiling-features">Profiling Features</a></h2>
<h3 id="tracing"><a class="header" href="#tracing"><code>tracing</code></a></h3>
<p>Rolling log files and <code>RUST_LOG</code> support via tracing-appender.</p>
<h3 id="tracy"><a class="header" href="#tracy"><code>tracy</code></a></h3>
<p>Real-time profiling with Tracy. Implies <code>tracing</code>.</p>
<h3 id="chrome"><a class="header" href="#chrome"><code>chrome</code></a></h3>
<p>Chrome tracing output for <code>chrome://tracing</code>. Implies <code>tracing</code>.</p>
<h2 id="plugin-features"><a class="header" href="#plugin-features">Plugin Features</a></h2>
<h3 id="plugins"><a class="header" href="#plugins"><code>plugins</code></a></h3>
<p>Guest-side WASM plugin API for creating plugins.</p>
<h3 id="plugin_runtime"><a class="header" href="#plugin_runtime"><code>plugin_runtime</code></a></h3>
<p>WASM plugin hosting via Wasmtime. Requires <code>assets</code>.</p>
<p><strong>Additional Dependencies:</strong> wasmtime, wasmtime-wasi, anyhow</p>
<h2 id="terminal-features"><a class="header" href="#terminal-features">Terminal Features</a></h2>
<h3 id="tui"><a class="header" href="#tui"><code>tui</code></a></h3>
<p>Terminal UI framework built on the engine's rendering. Includes <code>runtime</code> and <code>text</code>.</p>
<p><strong>Additional Dependencies:</strong> rand</p>
<h3 id="terminal"><a class="header" href="#terminal"><code>terminal</code></a></h3>
<p>Crossterm-based terminal applications without the full rendering pipeline.</p>
<p><strong>Additional Dependencies:</strong> crossterm, rand, freecs</p>
<h2 id="other-features"><a class="header" href="#other-features">Other Features</a></h2>
<h3 id="mcp"><a class="header" href="#mcp"><code>mcp</code></a></h3>
<p>Starts an HTTP-based <a href="https://modelcontextprotocol.io">Model Context Protocol</a> server on <code>http://127.0.0.1:3333/mcp</code> when the application launches. Any MCP client (Claude Code, Claude Desktop, or custom tooling) can connect and manipulate the running scene in real time through 50+ tools covering entities, transforms, materials, lighting, physics, animation, scripting, and more.</p>
<p>Requires <code>async_runtime</code> and <code>behaviors</code>. Native only (not available on WASM).</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["mcp"] }
</code></pre>
<p>Connect Claude Code to the running engine:</p>
<pre><code class="language-bash">claude mcp add --transport http nightshade http://127.0.0.1:3333/mcp
</code></pre>
<p>Applications can intercept MCP commands before the engine processes them by implementing <code>handle_mcp_command</code> on the <code>State</code> trait. See the <a href="ai-integration.html">AI Integration</a> chapter for details.</p>
<p><strong>Additional Dependencies:</strong> axum, rmcp, schemars</p>
<h3 id="claude"><a class="header" href="#claude"><code>claude</code></a></h3>
<p>Provides types and a background worker thread for spawning Claude Code CLI as a subprocess and streaming its JSON output. This lets applications embed an AI assistant that can send queries, receive streamed responses (text, thinking, tool use events), and manage sessions.</p>
<p>Native only (not available on WASM).</p>
<pre><code class="language-toml">nightshade = { git = "...", features = ["claude"] }
</code></pre>
<p>Key types:</p>
<ul>
<li><code>ClaudeConfig</code> — system prompt, allowed/disallowed tools, MCP config, custom CLI args</li>
<li><code>CliCommand</code> — <code>StartQuery</code> (with prompt, optional session ID and model) and <code>Cancel</code></li>
<li><code>CliEvent</code> — <code>SessionStarted</code>, <code>TextDelta</code>, <code>ThinkingDelta</code>, <code>ToolUseStarted</code>, <code>ToolUseInputDelta</code>, <code>ToolUseFinished</code>, <code>TurnComplete</code>, <code>Complete</code>, <code>Error</code></li>
</ul>
<p>When both <code>claude</code> and <code>mcp</code> are enabled, <code>McpConfig::Auto</code> automatically generates the MCP config JSON pointing at <code>http://127.0.0.1:3333/mcp</code>, so Claude Code connects to the engine without manual setup.</p>
<p><strong>Additional Dependencies:</strong> serde_json</p>
<h2 id="feature-combinations"><a class="header" href="#feature-combinations">Feature Combinations</a></h2>
<h3 id="minimal-rendering-app"><a class="header" href="#minimal-rendering-app">Minimal Rendering App</a></h3>
<pre><code class="language-toml">nightshade = { default-features = false, features = ["runtime", "wgpu", "egui"] }
</code></pre>
<p>Lightweight egui app without asset loading.</p>
<h3 id="standard-game"><a class="header" href="#standard-game">Standard Game</a></h3>
<pre><code class="language-toml">nightshade = { git = "...", features = ["egui", "physics", "audio", "gamepad"] }
</code></pre>
<p>Full game features with UI, physics, audio, and gamepad.</p>
<h3 id="open-world-game"><a class="header" href="#open-world-game">Open World Game</a></h3>
<pre><code class="language-toml">nightshade = { git = "...", features = [
    "egui",
    "physics",
    "audio",
    "gamepad",
    "navmesh",
] }
</code></pre>
<p>Everything for large outdoor environments with AI pathfinding.</p>
<h3 id="vr-game"><a class="header" href="#vr-game">VR Game</a></h3>
<pre><code class="language-toml">nightshade = { git = "...", features = ["openxr", "physics", "audio"] }
</code></pre>
<p>Virtual reality with physics and audio.</p>
<h3 id="music-visualizer"><a class="header" href="#music-visualizer">Music Visualizer</a></h3>
<pre><code class="language-toml">nightshade = { git = "...", features = ["audio", "fft"] }
</code></pre>
<p>Audio-reactive visualizations with FFT analysis.</p>
<h3 id="desktop-tool"><a class="header" href="#desktop-tool">Desktop Tool</a></h3>
<pre><code class="language-toml">nightshade = { git = "...", features = ["mosaic", "egui"] }
</code></pre>
<p>Multi-pane desktop application with dockable widgets.</p>
<h3 id="custom-scene-editor"><a class="header" href="#custom-scene-editor">Custom Scene Editor</a></h3>
<pre><code class="language-toml">nightshade = { git = "...", features = ["editor", "fbx", "physics", "navmesh"] }
</code></pre>
<p>Full scene editor with gizmos, inspectors, undo/redo, FBX import, physics colliders, and navmesh editing.</p>
<h2 id="feature-dependencies"><a class="header" href="#feature-dependencies">Feature Dependencies</a></h2>
<p>Some features have implicit dependencies:</p>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Depends On</th></tr></thead><tbody>
<tr><td><code>engine</code></td><td><code>runtime</code>, <code>assets</code>, <code>scene_graph</code>, <code>picking</code>, <code>terrain</code>, <code>file_dialog</code>, <code>async_runtime</code>, <code>screenshot</code></td></tr>
<tr><td><code>runtime</code></td><td><code>core</code>, <code>text</code>, <code>behaviors</code></td></tr>
<tr><td><code>full</code></td><td><code>engine</code>, <code>wgpu</code>, <code>egui</code>, <code>shell</code>, <code>audio</code>, <code>physics</code>, <code>gamepad</code>, <code>navmesh</code>, <code>scripting</code>, <code>fbx</code>, <code>lattice</code>, <code>sdf_sculpt</code>, <code>mosaic</code>, <code>editor</code>, <code>plugins</code></td></tr>
<tr><td><code>mosaic</code></td><td><code>egui</code></td></tr>
<tr><td><code>editor</code></td><td><code>mosaic</code>, <code>picking</code></td></tr>
<tr><td><code>shell</code></td><td><code>egui</code></td></tr>
<tr><td><code>fbx</code></td><td><code>assets</code></td></tr>
<tr><td><code>scene_graph</code></td><td><code>assets</code></td></tr>
<tr><td><code>assets</code></td><td><code>core</code></td></tr>
<tr><td><code>text</code></td><td><code>core</code></td></tr>
<tr><td><code>terrain</code></td><td><code>core</code></td></tr>
<tr><td><code>tui</code></td><td><code>runtime</code>, <code>text</code></td></tr>
<tr><td><code>plugin_runtime</code></td><td><code>assets</code></td></tr>
<tr><td><code>mcp</code></td><td><code>async_runtime</code>, <code>behaviors</code></td></tr>
<tr><td><code>claude</code></td><td>(none)</td></tr>
<tr><td><code>tracy</code></td><td><code>tracing</code></td></tr>
<tr><td><code>chrome</code></td><td><code>tracing</code></td></tr>
<tr><td><code>openxr</code></td><td><code>wgpu</code> (Vulkan backend)</td></tr>
</tbody></table>
</div>
<h2 id="checking-enabled-features"><a class="header" href="#checking-enabled-features">Checking Enabled Features</a></h2>
<p>Use <code>cfg</code> attributes for conditional compilation:</p>
<pre><pre class="playground"><code class="language-rust edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn initialize(&amp;mut self, world: &amp;mut World) {
    let camera = spawn_camera(world, Vec3::new(5.0, 3.0, 5.0), "Camera".to_string());
    world.resources.active_camera = Some(camera);
    spawn_sun(world);

    #[cfg(feature = "physics")]
    {
        let entity = world.spawn_entities(
            RIGID_BODY | COLLIDER | LOCAL_TRANSFORM | GLOBAL_TRANSFORM | LOCAL_TRANSFORM_DIRTY | RENDER_MESH,
            1,
        )[0];
        world.set_rigid_body(entity, RigidBodyComponent::new_dynamic());
        world.set_collider(entity, ColliderComponent::cuboid(0.5, 0.5, 0.5));
    }

    #[cfg(feature = "audio")]
    {
        let source = world.spawn_entities(AUDIO_SOURCE | LOCAL_TRANSFORM | GLOBAL_TRANSFORM, 1)[0];
        world.set_audio_source(source, AudioSource::new("music").with_looping(true).playing());
    }
}
<span class="boring">}</span></code></pre></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="example-physics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="appendix-platforms.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="example-physics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="appendix-platforms.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
